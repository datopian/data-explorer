{"version":3,"sources":["../node_modules/tableschema/lib/profiles sync /^/.//.*/.json$","utils/index.js","reducers/rootReducer.js","reducers/dataViewBuilderReducer.js","reducers/filterUIReducer.js","reducers/sharedStateReducer.js","store.js","components/DataView/index.js","utils/loadDataset.js","actions/index.js","App.js","serviceWorker.js","index.js"],"names":["map","./geojson.json","./table-schema.json","./topojson.json","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","getEmptyView","datapackage","resources","schema","getDataViewChartBuilderView","views","length","getResourceForFiltering","deepClone","obj","JSON","parse","stringify","combineReducers","dataViewBuilder","state","arguments","undefined","type","filterUI","sharedState","action","unshift","payload","assign","mapBuilderDp","forEach","view","index","specType","filteredDatapackage","loading","error","errorBody","initialState","loadedData","DataView","props","react_default","a","createElement","react_loader_default","loaded","style","position","dist_App","key","Math","random","toArray","require","parseDatapackageIdentifier","stringOrJSON","compile","descriptor","dpRender","loadDataset","_ref","asyncToGenerator","regenerator_default","mark","_callee2","dpID","DP_ID","tabularFormats","dataset","wrap","_context2","prev","next","Dataset","load","sent","Promise","all","_ref2","_callee","file","response","result","rowStream","data","_response","_result","_context","displayName","abrupt","path","includes","fetch","ok","unavailable","json","records","format","rows","size","keyed","addSchema","t0","console","warn","toLowerCase","stop","_x2","apply","this","_x","fetchDataBegin","fetchDataSuccess","res","_objectSpread","connect","App_objectSpread","dispatch","filterUIAction","getState","newDatapackage","datastore_active","fetchDataAction","_x3","dataViewBuilderAction","actionType","useEffect","chartBuilder","controls","showChartBuilder","className","chart_builder_dist","mapBuilder","showMapBuilder","map_builder_dist","find","dist","resource","filterBuilderAction","Boolean","window","location","hostname","match","instances","document","getElementsByClassName","_step","_iterator","Symbol","iterator","_iteratorNormalCompletion","done","instance","value","getAttribute","ReactDOM","render","es","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","src_App_0","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.bad34fac.chunk.js","sourcesContent":["var map = {\n\t\"./geojson.json\": 456,\n\t\"./table-schema.json\": 874,\n\t\"./topojson.json\": 457\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 873;","export const getEmptyView = datapackage => {\n  try {\n    return {resources: [{schema: datapackage.resources[0].schema}]}\n  } catch (e) {\n    return {}\n  }\n}\n\nexport const getDataViewChartBuilderView = (datapackage) => {\n  if (!datapackage) return {}\n\n  const views = datapackage.views || []\n\n  switch (views.length) {\n    case 1:\n      return datapackage.views[0]\n    case 2:\n      return datapackage.views[1]\n    case 3:\n      return datapackage.views[2]\n    default:\n      return getEmptyView(datapackage)\n  }\n}\n\nexport const getDataViewMapBuilderView = (datapackage) => {\n  if (!datapackage) return {}\n\n  const views = datapackage.views || []\n\n  return views.find(view => view.specType === 'tabularmap') || getEmptyView(datapackage)\n}\n\nexport const getResourceForFiltering = (datapackage) => {\n  if (!datapackage) return {}\n  return datapackage.resources[0]\n}\n\nexport const deepClone = obj => {\n  return JSON.parse(JSON.stringify(obj))\n}\n","import { combineReducers } from 'redux'\nimport { default as dataViewBuilder } from './dataViewBuilderReducer'\nimport { default as filterUI } from './filterUIReducer'\nimport { default as sharedState } from './sharedStateReducer'\n\nexport default combineReducers({\n dataViewBuilder, filterUI, sharedState\n})\n","export default (state = {}, action) => {\n switch (action.type) {\n  case 'DATA_VIEW_CHART_BUILDER_ACTION':\n    return state\n  default:\n    return state\n }\n}\n","export default (state = {}, action) => {\n switch (action.type) {\n  case 'FILTER_UI_ACTION':\n   return state \n  default:\n   return state\n }\n}\n","import { deepClone } from '../utils'\n\nexport default (state = {}, action) => {\n  switch (action.type) {\n    case 'DATA_VIEW_CHART_BUILDER_ACTION':\n      const datapackage = deepClone(state.datapackage)\n\n      if (datapackage.views.length <= 2) {\n        datapackage.views.unshift(action.payload)\n      }\n\n      if (datapackage.views.length > 2) {\n        datapackage.views[0] = action.payload\n      }\n\n      const newState = Object.assign(deepClone(state), {datapackage})\n      return newState\n    case 'DATA_VIEW_MAP_BUILDER_ACTION':\n      const mapBuilderDp = deepClone(state.datapackage)\n      mapBuilderDp.views.forEach((view, index) => {\n        if (view.specType === 'tabularmap') {\n          mapBuilderDp.views[index] = action.payload\n        }\n      })\n      const mapBuilderState = Object.assign(deepClone(state), {datapackage: mapBuilderDp})\n      return mapBuilderState\n    case 'FILTER_UI_ACTION':\n      const filteredDatapackage = deepClone(state.datapackage)\n      filteredDatapackage.resources[0] = action.payload\n      const filteredState = Object.assign(deepClone(state), {datapackage: filteredDatapackage})\n      return filteredState\n    case 'FETCH_DATA_BEGIN':\n      return Object.assign({}, state, {loading: true})\n    case 'FETCH_DATA_SUCCESS':\n      return Object.assign({}, state, {loading: false, error: false, datapackage: action.payload.datapackage})\n    case 'FETCH_DATA_FAILURE':\n      return Object.assign({}, state, {loading: false, error: true, errorBody: action.payload})\n    default:\n     return state\n  }\n}\n","import { createStore, applyMiddleware } from 'redux'\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers/rootReducer'\n\nconst initialState = {\n  dataViewBuilder: {\n    // chartBuilder state\n  },\n  filterUI: {\n    // UIState\n  },\n  sharedState: {\n    loading: false,\n    datapackage: {},\n    loadedData: {} // not implemented\n  }\n}\n\nexport default function configureStore(props) {\n \n return createStore(\n   rootReducer,\n   Object.assign({}, initialState, props),\n   composeWithDevTools(applyMiddleware(thunk))\n )\n}\n","import React from 'react'\nimport Loader from 'react-loader'\nimport { DataView } from '@datopian/datapackage-views-js'\n\nexport default props => {\n  const views = props.datapackage.views\n\n  return (\n  <Loader loaded={!props.loading} style={{position: \"relative\"}}>\n    <div>\n     {\n        views.map(view => <DataView key={Math.random()} datapackage={{views: [view]}} />)\n     }\n    </div>\n  </Loader>\n  )\n}\n","import * as dpRender from 'datapackage-render'\nimport { Dataset } from 'data.js'\n\nvar toArray = require('stream-to-array')\n\nfunction parseDatapackageIdentifier(stringOrJSON) {\n  try {\n    return JSON.parse(stringOrJSON)\n  } catch (e) {\n    return stringOrJSON\n  }\n}\n\nfunction compile(descriptor) {\n  return descriptor.views.map(view => {\n    return dpRender.compileView(view, descriptor)\n  })\n}\n\n// needs to be encapsulated\n// should be library code\nexport default async dpID => {\n  const DP_ID = parseDatapackageIdentifier(dpID)\n  const tabularFormats = ['csv', 'tsv', 'dsv', 'xls', 'xlsx']\n\n  try {\n    const dataset = await Dataset.load(DP_ID)\n\n    // TODO why is this happening here? This looks like library code\n    // TODO clean up! this shouldn't handle mutation of descriptor along\n    //      side of fetching resources etc... a mess\n    await Promise.all(dataset.resources.map(async (file) => {\n      if (file.displayName === 'FileInline') {\n        return\n      } else if (file.descriptor.path && file.descriptor.path.includes('datastore_search')) {\n        // Datastore, e.g., when a path is a 'datastore_search' API\n        const response = await fetch(file.descriptor.path)\n        if (!response.ok) {\n          file.descriptor.unavailable = true\n          return\n        }\n        const result = await response.json()\n        file.descriptor.data = result.result.records\n      } else if (file.displayName === \"FileRemote\" && tabularFormats.includes(file.descriptor.format)) {\n        // Tabular data\n        try {\n          const rowStream = await file.rows({size: 100, keyed: true})\n          const data = await toArray(rowStream)\n          if (data.length > 0) {\n            file.descriptor.data = data // This makes it FileInline\n          } else {\n            file.descriptor.unavailable = true\n          }\n          await file.addSchema()\n        } catch (e) {\n          console.warn(e)\n          file.descriptor.unavailable = true\n        }\n      } else if (file.descriptor.format.toLowerCase().includes('json')) {\n        // Geographical data\n        const response = await fetch(file.descriptor.path)\n        if (!response.ok) {\n          file.descriptor.unavailable = true\n          return\n        }\n        const result = await response.json()\n        // The '.json' files can contain geo data - check by its 'type' property\n        const geoJsonTypes = [\n          'Feature', 'FeatureCollection', 'Point', 'MultiPoint', 'LineString',\n          'MultiLineString', 'Polygon', 'MultiPolygon', 'GeometryCollection'\n        ]\n        if (geoJsonTypes.includes(result.type)) {\n          file.descriptor.data = result\n        } else {\n          // It isn't a valid GeoJSON\n          file.descriptor.unavailable = true\n          return\n        }\n      } else if (file.descriptor.format.toLowerCase() === 'pdf') {\n        return\n      } else {\n        // We can't load any other data types for now.\n        file.descriptor.unavailable = true\n      }\n    }))\n\n    return compile(dataset.descriptor)\n  } catch (e) {\n    console.warn('Failed to load a Dataset from provided datapackage id\\n' + e)\n    return DP_ID\n  }\n}\n","import loadDataset from '../utils/loadDataset'\n\nexport const filterUIAction = (payload) => async (dispatch, getState) => {\n dispatch({\n  type: 'FILTER_UI_ACTION',\n  payload\n })\n const datapackage = getState().sharedState.datapackage\n // For datastore resources, we need to remove loaded `data` attribute to\n // trigger re-fetch of a resource. This is required since we initially fetch\n // only subset of data from datastore, eg, first 100 rows. When user applies\n // filters, we need to hit datastore api and update the data.\n if (datapackage.resources[0].datastore_active) {\n   delete datapackage.resources[0].data\n }\n dispatch(fetchDataBegin())\n const views = await loadDataset(datapackage)\n const newDatapackage = JSON.parse(JSON.stringify(datapackage))\n newDatapackage.views = views\n dispatch(fetchDataSuccess({datapackage: newDatapackage}))\n}\n\nexport const dataViewBuilderAction = (payload) => dispatch => {\n  let actionType\n  if (payload.specType === 'simple') {\n    actionType = 'DATA_VIEW_CHART_BUILDER_ACTION'\n  } else if (payload.specType === 'tabularmap') {\n    actionType = 'DATA_VIEW_MAP_BUILDER_ACTION'\n  }\n  dispatch({\n    type: actionType,\n    payload\n  })\n}\n\nexport const fetchDataAction = payload => async dispatch => {\n  dispatch(fetchDataBegin())\n  const views = await loadDataset(payload.datapackage)\n  const newDatapackage = JSON.parse(JSON.stringify(payload.datapackage))\n  newDatapackage.views = views\n  dispatch(fetchDataSuccess({datapackage: newDatapackage}))\n}\n\nconst fetchDataBegin = () => ({\n  type: 'FETCH_DATA_BEGIN'\n})\n\nconst fetchDataSuccess = res => ({\n  type: 'FETCH_DATA_SUCCESS',\n  payload: { ...res }\n})\n\nconst fetchDataFailure = err => ({\n  type: 'FETCH_DATA_FAILURE',\n  payload: { err }\n})\n","import React, {useEffect} from 'react';\nimport { connect } from 'react-redux';\nimport './App.css';\nimport { QueryBuilder } from 'datastore-query-builder';\nimport DataView from './components/DataView';\nimport { ChartBuilder } from 'chart-builder';\nimport { MapBuilder } from 'map-builder';\nimport { filterUIAction, fetchDataAction, dataViewBuilderAction } from './actions/';\nimport { getDataViewChartBuilderView, getDataViewMapBuilderView, getResourceForFiltering } from './utils';\n\nexport const App = props => {\n  useEffect(() => {\n    const payload = {\n      datapackage: props.sharedState.datapackage\n    }\n    props.fetchDataAction(payload)\n  }, [])\n\n  const showChartBuilder = props.sharedState.datapackage.controls && props.sharedState.datapackage.controls.showChartBuilder\n  const chartBuilder = (showChartBuilder) && (\n        <div className=\"p-4 mr-4\">\n          <ChartBuilder view={getDataViewChartBuilderView(props.sharedState.datapackage)} dataViewBuilderAction={props.dataViewBuilderAction} />\n        </div>\n      )\n  const showMapBuilder = props.sharedState.datapackage.controls && props.sharedState.datapackage.controls.showMapBuilder\n  const mapBuilder = (showMapBuilder) && (\n        <div className=\"p-4 mr-4\">\n          <MapBuilder view={getDataViewMapBuilderView(props.sharedState.datapackage)} dataViewBuilderAction={props.dataViewBuilderAction} />\n        </div>\n      )\n\n  return (\n    <div className=\"text-center ml-6\">\n      <div className=\"container py-4\">\n        <div className=\"\">\n          <QueryBuilder resource={getResourceForFiltering(props.sharedState.datapackage)} filterBuilderAction={props.filterUIAction} />\n        </div>\n      </div>\n      <div className=\"container flex py-6\">\n        <div className=\"w-3/4 p-3 mr-4\">\n          <DataView {...props.sharedState} />\n        </div>\n        <div className=\"w-1/4\">\n          <div className=\"w-full\">\n            {chartBuilder}\n          </div>\n          <div className=\"w-full\">\n            {mapBuilder}\n          </div>\n        </div>\n      </div>\n     </div>\n  )\n}\n\nconst mapStateToProps = state => ({\n ...state\n})\n\nconst mapDispatchToProps = dispatch => ({\n filterUIAction: (payload) => dispatch(filterUIAction(payload)),\n fetchDataAction: payload => dispatch(fetchDataAction(payload)),\n dataViewBuilderAction: payload => dispatch(dataViewBuilderAction(payload))\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport configureStore from './store'\nimport './App.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker';\n\n\nconst instances = document.getElementsByClassName('data-explorer')\n\nfor (const instance of instances) {\n  try {\n    const datapackage=JSON.parse(instance.getAttribute('data-datapackage'))\n\n    ReactDOM.render(\n     <Provider store={configureStore({sharedState: {datapackage}})}>\n      <App />\n     </Provider>, document.getElementById(instance.id)\n    )\n  } catch (e) {\n    console.warn('Failed to render data-explorer', e)\n  }\n}\n\nserviceWorker.unregister();\n"],"sourceRoot":""}